setwd("/Users/Alex/Documents/mitorc/2-iap2015/OR-software-tools-2016")
setwd("/Users/Alex/Documents/mitorc/2-iap2015/OR-software-tools-2016/2-data-wrangling/")
date1 = read.csv("2013-05-14.csv")
neighborhoods = read.csv("2013-05-14_neighborhoods.csv")
str(date1)
str(neighborhoods)
taxidata = read.csv("2013-05-14_neighborhoods.csv")
taxidata = read.csv("2013-05-14_neighborhoods.csv",stringsAsFactors=F)
str(neighborhoods)
library(dplyr)
library(tidyr)
library(ggplot2)
rm(neighborhoods)
str(taxidata)
ggplot(taxidata,aes(x=passenger_count)) + geom_histogram()
taxidata %>% count(passenger_count)
ggplot(taxidata,aes(x=trip_distance)) + geom_histogram()
ggplot(taxidata,aes(x=trip_distance)) + geom_histogram(binwidth=0.5)
taxidata %>% ggplot(aes(x=trip_distance,y=tip_amount)) + geom_point()
taxidata %>%
group_by(passenger_count) %>%
summarize(
fare25 = quantile(fare_amount,0.25),
fare50 = median(fare_amount),
fare75 = quantile(fare_amount,0.75),
faremean = mean(fare_amount)
)
summary(taxidata$passenger_count)
taxidata %>% count(passenger_count)
taxidata %>%
group_by(passenger_count) %>%
summarize(
fare25 = quantile(fare_amount,0.25),
fare50 = median(fare_amount),
fare75 = quantile(fare_amount,0.75),
faremean = mean(fare_amount),
n = n()
)
taxidata %>% count(passenger_count)
names(taxidata)
sd(taxidata$fare_amount)
taxidata$passenger_count %>% table()
taxidata$passenger_count %>% table() %>% data.frame()
taxidata$passenger_count %>% table() %>% data.frame() %>% plot()
taxidata$passenger_count %>% table() %>%plot()
taxidata$passenger_count %>% table() %>% plot()
(taxidata$passenger_count - mean(taxidata$passenger_count))^2 %>% sum() %>% sqrt()
sd(taxidata$passenger_count)
(taxidata$fare_amount - mean(taxidata$fare_amount))^2 %>% mean() %>% sqrt()
sd(taxidata$fare_amount)
taxidata$passenger_count %>% table() %>% plot()
taxidata %>%
group_by(passenger_count) %>%
summarize(faremean = mean(fare_amount))
taxidata %>%
group_by(passenger_count) %>%
summarize(
faremean = mean(fare_amount),
faremedian = median(fare_amount)
)
table(taxidata$passenger_count)
taxidata %>%
filter(passenger_count != 0)
taxidata %>%
tbl_df %>%
filter(passenger_count != 0)
taxidata %>%
tbl_df %>%
subset(passenger_count != 0)
taxidata %>%
group_by(passenger_count) %>%
summarize(
faremean = mean(fare_amount),
faremedian = median(fare_amount)
)
table(taxidata$passenger_count)
taxidata = tbl_df(taxidata)
taxidata
names(taxidata)
taxidata %>%
select(passenger_count,fare_amount,tip_amount)
taxidata %>%
select(passenger_count,fare_amount,tip_amount) %>%
mutate(tip_percent = tip_amount / fare_amount)
taxidata %>%
select(passenger_count,fare_amount,tip_amount) %>%
mutate(tip_percent = tip_amount / fare_amount) %>%
summary()
taxidata %>%
select(passenger_count,fare_amount,tip_amount) %>%
mutate(tip_percent = tip_amount / fare_amount) %>%
summary()
taxidata %>%
select(passenger_count,fare_amount,tip_amount) %>%
mutate(tip_percent = tip_amount / fare_amount) %>%
filter(tip_percent > 1)
taxidata %>%
select(passenger_count,fare_amount,tip_amount) %>%
mutate(tip_percent = tip_amount / fare_amount) %>%
filter(tip_percent > 3)
linregdata = taxidata %>%
select(passenger_count,fare_amount,tip_amount) %>%
mutate(tip_percent = tip_amount / fare_amount)
mod = lm(tip_amount ~ ., data=linregdata)
summary(mod)
linregdata = taxidata %>%
select(passenger_count,fare_amount,tip_amount) %>%
mutate(tip_percent = tip_amount / fare_amount) %>%
select(-tip_amount)
mod = lm(tip_percent ~ ., data=linregdata)
summary(mod)
taxidata %>% ggplot(aes(x=fare_amount,y=tip_amount)) + geom_point()
dev.off()
taxidata %>% ggplot(aes(x=fare_amount,y=tip_amount)) + geom_point()
names(taxidata)
taxidata %>% count(pdistrict,ddistrict)
taxidata %>%
filter(passenger_count != 0) %>%
summarize(
faremean = mean(fare_amount),
faremedian = median(fare_amount)
) %>%
arrange(faremean)
# Let's sort by faremean
taxidata %>%
summarize(
faremean = mean(fare_amount),
faremedian = median(fare_amount)
) %>%
filter(passenger_count != 0) %>%
arrange(faremean)
taxidata %>%
group_by(passenger_count) %>%
summarize(
faremean = mean(fare_amount),
faremedian = median(fare_amount)
) %>%
filter(passenger_count != 0) %>%
arrange(faremean)
taxidata %>%
group_by(passenger_count) %>%
summarize(
faremean = mean(fare_amount),
faremedian = median(fare_amount)
) %>%
filter(passenger_count != 0) %>%
arrange(dec(faremean))
taxidata %>%
group_by(passenger_count) %>%
summarize(
faremean = mean(fare_amount),
faremedian = median(fare_amount)
) %>%
filter(passenger_count != 0) %>%
arrange(desc(faremean))
taxidata %>% count(pdistrict,ddistrict)
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
)
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
)
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
) %>%
spread(pdistrict,ddistrict)
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
) %>%
spread(ddistrict,n)
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
) %>%
spread(ddistrict,n,fill=0)
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
) %>%
ggplot(aes(x=pdistrict,y=ddistrict)) + geom_point(aes(size=n))
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
) %>%
ggplot(aes(x=pdistrict,y=ddistrict)) + geom_point(aes(size=n,alpha=n))
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
) %>%
arrange(desc(n))
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
) %>%
ungroup %>%
arrange(desc(n))
taxidata %>%
count(pdistrict,ddistrict) %>%
filter(
!is.na(pdistrict),
!is.na(ddistrict)
) %>%
spread(ddistrict,n,fill=0)
names(taxidata)
taxidata %>% count(passenger_count,rate_code)
taxidata %>% count(passenger_count,rate_code) %>% spread(rate_code,n,fill=0)
taxidata %>% filter(passenger_count > 0) %>% count(passenger_count,rate_code) %>% spread(rate_code,n,fill=0)
mylist = list(0)
mylist[[1]] = "Standard Rate"
mylst[[2]] = "JFK"
mylist[[2]] = "JFK"
mylist
1:6
names(taxidata)
rate_code_map = data.frame(RateClass = c("Standard rate", "JFK", "Newark", "Nassau", "Westchester", "Negotiated fare", "Group ride"), rate_code = 1:6)
rate_code_map = data.frame(RateClass = c("Standard rate", "JFK", "Newark", "Nassau or Westchester", "Negotiated fare", "Group ride"), rate_code = 1:6)
rate_code_map
rate_code_map = data.frame(RateClass = c("Standard rate", "JFK", "Newark", "Nassau or Westchester", "Negotiated fare", "Group ride"), Code = 1:6)
write.csv(rate_code_map,"rate_code_map.csv",row.names = F)
read.csv("rate_code_map.csv")
rate_code_map = read.csv("rate_code_map.csv",stringsAsFactors = F)
taxidata %>%
select(passenger_count,rate_code)
rate_code_map
taxidata %>%
select(passenger_count,Code=rate_code)
taxidata %>%
select(passenger_count,Code=rate_code) %>%
left_join(rate_code_map)
taxidata %>%
select(passenger_count,Code=rate_code) %>%
left_join(rate_code_map) %>%
count(passenger_count,RateClass)
taxidata %>%
select(passenger_count,Code=rate_code) %>%
left_join(rate_code_map) %>%
count(passenger_count,RateClass) %>%
spread(passenger_count,n,fill=0)
